<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>App Manager: Rules Specification | App Manager 文档</title>
    <meta name="generator" content="VuePress 1.5.4">
    
    <meta name="description" content="A full-featured package manager and viewer for Android">
    <meta name="theme-color" content="#3eaf7c">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="preload" href="/AppManager/assets/css/0.styles.379cc2a4.css" as="style"><link rel="preload" href="/AppManager/assets/js/app.f133bcc3.js" as="script"><link rel="preload" href="/AppManager/assets/js/2.3aad57dd.js" as="script"><link rel="preload" href="/AppManager/assets/js/58.f23a0aaa.js" as="script"><link rel="prefetch" href="/AppManager/assets/js/10.7b01e52f.js"><link rel="prefetch" href="/AppManager/assets/js/11.2a83a501.js"><link rel="prefetch" href="/AppManager/assets/js/12.cd2379a0.js"><link rel="prefetch" href="/AppManager/assets/js/13.7ec06f0d.js"><link rel="prefetch" href="/AppManager/assets/js/14.e3c9a742.js"><link rel="prefetch" href="/AppManager/assets/js/15.8bfb1466.js"><link rel="prefetch" href="/AppManager/assets/js/16.670c2789.js"><link rel="prefetch" href="/AppManager/assets/js/17.3e80ef2f.js"><link rel="prefetch" href="/AppManager/assets/js/18.8a7b3a4e.js"><link rel="prefetch" href="/AppManager/assets/js/19.fcf09253.js"><link rel="prefetch" href="/AppManager/assets/js/20.2529eb12.js"><link rel="prefetch" href="/AppManager/assets/js/21.b64e4131.js"><link rel="prefetch" href="/AppManager/assets/js/22.6497f0a1.js"><link rel="prefetch" href="/AppManager/assets/js/23.100eafaf.js"><link rel="prefetch" href="/AppManager/assets/js/24.12f7b7a8.js"><link rel="prefetch" href="/AppManager/assets/js/25.65f5065b.js"><link rel="prefetch" href="/AppManager/assets/js/26.468c27cd.js"><link rel="prefetch" href="/AppManager/assets/js/27.a15170d4.js"><link rel="prefetch" href="/AppManager/assets/js/28.e0c9e89a.js"><link rel="prefetch" href="/AppManager/assets/js/29.56b4a1f3.js"><link rel="prefetch" href="/AppManager/assets/js/3.69252a74.js"><link rel="prefetch" href="/AppManager/assets/js/30.29823b1e.js"><link rel="prefetch" href="/AppManager/assets/js/31.e3efe8a1.js"><link rel="prefetch" href="/AppManager/assets/js/32.3b06fb28.js"><link rel="prefetch" href="/AppManager/assets/js/33.d3fc912d.js"><link rel="prefetch" href="/AppManager/assets/js/34.e0cfae5d.js"><link rel="prefetch" href="/AppManager/assets/js/35.2f3451cf.js"><link rel="prefetch" href="/AppManager/assets/js/36.a6cb0dc7.js"><link rel="prefetch" href="/AppManager/assets/js/37.75d718aa.js"><link rel="prefetch" href="/AppManager/assets/js/38.55b8229a.js"><link rel="prefetch" href="/AppManager/assets/js/39.327d043d.js"><link rel="prefetch" href="/AppManager/assets/js/4.ed75571d.js"><link rel="prefetch" href="/AppManager/assets/js/40.17b7737b.js"><link rel="prefetch" href="/AppManager/assets/js/41.aabd664f.js"><link rel="prefetch" href="/AppManager/assets/js/42.270fc4e3.js"><link rel="prefetch" href="/AppManager/assets/js/43.2245498c.js"><link rel="prefetch" href="/AppManager/assets/js/44.628490ed.js"><link rel="prefetch" href="/AppManager/assets/js/45.432d228e.js"><link rel="prefetch" href="/AppManager/assets/js/46.19a44164.js"><link rel="prefetch" href="/AppManager/assets/js/47.df85b57e.js"><link rel="prefetch" href="/AppManager/assets/js/48.49a4b334.js"><link rel="prefetch" href="/AppManager/assets/js/49.c7b17af4.js"><link rel="prefetch" href="/AppManager/assets/js/5.70abd262.js"><link rel="prefetch" href="/AppManager/assets/js/50.35b3aa09.js"><link rel="prefetch" href="/AppManager/assets/js/51.6440091b.js"><link rel="prefetch" href="/AppManager/assets/js/52.30fbce64.js"><link rel="prefetch" href="/AppManager/assets/js/53.342844b9.js"><link rel="prefetch" href="/AppManager/assets/js/54.1873afb5.js"><link rel="prefetch" href="/AppManager/assets/js/55.f7f4aa8a.js"><link rel="prefetch" href="/AppManager/assets/js/56.bc5260c1.js"><link rel="prefetch" href="/AppManager/assets/js/57.e07ebd1d.js"><link rel="prefetch" href="/AppManager/assets/js/6.fb5952bb.js"><link rel="prefetch" href="/AppManager/assets/js/7.9cfff32f.js"><link rel="prefetch" href="/AppManager/assets/js/8.7bf35f6e.js"><link rel="prefetch" href="/AppManager/assets/js/9.37ccad10.js">
    <link rel="stylesheet" href="/AppManager/assets/css/0.styles.379cc2a4.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/AppManager/zh-CN/" class="home-link router-link-active"><img src="/AppManager/icon.png" alt="App Manager 文档" class="logo"> <span class="site-name can-hide">App Manager 文档</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/AppManager/zh-CN/guide/" class="nav-link">
  指南
</a></div><div class="nav-item"><a href="/AppManager/zh-CN/changelog.html" class="nav-link">
  更新日志
</a></div><div class="nav-item"><a href="https://f-droid.org/packages/io.github.muntashirakon.AppManager" target="_blank" rel="noopener noreferrer" class="nav-link external">
  F-Droid
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://github.com/MuntashirAkon/AppManager" target="_blank" rel="noopener noreferrer" class="nav-link external">
  源码
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="语言" class="dropdown-title"><span class="title">语言</span> <span class="arrow down"></span></button> <button type="button" aria-label="语言" class="mobile-dropdown-title"><span class="title">语言</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/AppManager/tech/rules-specification.html" class="nav-link">
  English
</a></li><li class="dropdown-item"><!----> <a href="/AppManager/ru/tech/rules-specification.html" class="nav-link">
  Русский
</a></li><li class="dropdown-item"><!----> <a href="/AppManager/zh-CN/tech/rules-specification.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  简体中文
</a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/AppManager/zh-CN/guide/" class="nav-link">
  指南
</a></div><div class="nav-item"><a href="/AppManager/zh-CN/changelog.html" class="nav-link">
  更新日志
</a></div><div class="nav-item"><a href="https://f-droid.org/packages/io.github.muntashirakon.AppManager" target="_blank" rel="noopener noreferrer" class="nav-link external">
  F-Droid
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://github.com/MuntashirAkon/AppManager" target="_blank" rel="noopener noreferrer" class="nav-link external">
  源码
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="语言" class="dropdown-title"><span class="title">语言</span> <span class="arrow down"></span></button> <button type="button" aria-label="语言" class="mobile-dropdown-title"><span class="title">语言</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/AppManager/tech/rules-specification.html" class="nav-link">
  English
</a></li><li class="dropdown-item"><!----> <a href="/AppManager/ru/tech/rules-specification.html" class="nav-link">
  Русский
</a></li><li class="dropdown-item"><!----> <a href="/AppManager/zh-CN/tech/rules-specification.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  简体中文
</a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>指南</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/AppManager/zh-CN/guide/" class="sidebar-link">简介</a></li><li><a href="/AppManager/zh-CN/guide/adb-over-tcp.html" class="sidebar-link">基于TCP的ADB</a></li><li><a href="/AppManager/zh-CN/guide/main-page.html" class="sidebar-link">主界面</a></li><li><a href="/AppManager/zh-CN/guide/app-details-page.html" class="sidebar-link">应用详情页</a></li><li><a href="/AppManager/zh-CN/guide/one-click-ops-page.html" class="sidebar-link">一键操作</a></li><li><a href="/AppManager/zh-CN/guide/exodus-page.html" class="sidebar-link">εxodus 页</a></li><li><a href="/AppManager/zh-CN/guide/shared-pref-editor-page.html" class="sidebar-link">Shared Preferences Editor Page</a></li><li><a href="/AppManager/zh-CN/guide/settings-page.html" class="sidebar-link">设置页</a></li></ul></section></li><li><section class="sidebar-group depth-0"><a href="/AppManager/zh-CN/faq" class="sidebar-heading clickable"><span>常见问题</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/AppManager/zh-CN/faq/app-components.html" class="sidebar-link">应用组件</a></li><li><a href="/AppManager/zh-CN/faq/adb.html" class="sidebar-link">基于TCP的ADB</a></li><li><a href="/AppManager/zh-CN/faq/misc.html" class="sidebar-link">其他</a></li></ul></section></li><li><section class="sidebar-group depth-0"><a href="/AppManager/zh-CN/tech" class="sidebar-heading clickable router-link-active open"><span>技术信息</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/AppManager/zh-CN/tech/AppOps.html" class="sidebar-link">App Ops</a></li><li><a href="/AppManager/zh-CN/tech/rules-specification.html" aria-current="page" class="active sidebar-link">App Manager: Rules Specification</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/AppManager/zh-CN/tech/rules-specification.html#background" class="sidebar-link">Background</a></li><li class="sidebar-sub-header"><a href="/AppManager/zh-CN/tech/rules-specification.html#rules-file-format" class="sidebar-link">Rules File Format</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/AppManager/zh-CN/tech/rules-specification.html#internal" class="sidebar-link">Internal</a></li><li class="sidebar-sub-header"><a href="/AppManager/zh-CN/tech/rules-specification.html#external" class="sidebar-link">External</a></li></ul></li></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="app-manager-rules-specification"><a href="#app-manager-rules-specification" class="header-anchor">#</a> App Manager: Rules Specification</h1> <p><em>Go to the <a href="https://github.com/MuntashirAkon/AppManager/issues/24" target="_blank" rel="noopener noreferrer">related issue<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> for discussion.</em></p> <p><strong>App Manager</strong> currently supports blocking activities, broadcast receivers, content providers, services, app ops and permissions, and in future I may add more blocking options. In order to add more portability, it is necessary to import/export all these data.</p> <details class="custom-block details"><summary>Table of Contents</summary> <p></p><div class="table-of-contents"><ul><li><a href="#background">Background</a></li><li><a href="#rules-file-format">Rules File Format</a><ul><li><a href="#internal">Internal</a></li><li><a href="#external">External</a></li></ul></li></ul></div><p></p></details> <h2 id="background"><a href="#background" class="header-anchor">#</a> Background</h2> <p>All configuration files are stored at <tt>/data/data/io.github.muntashirakon.AppManager/Files/conf</tt>, and <tt>/sdcard/Android/data/io.github.muntashirakon.AppManager/Files/ifw</tt> is used as a temporary storage. The latter directory is kept to provide compatibility for App Manager v2.5.5 or older as well. This latter directory will be removed in v2.6 as it is not secured to store sensitive data in the shared storage as any app having access to these directories can create or modify these files.</p> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>From v2.5.6, this latter directory is mostly kept for temporary storage. If you're upgrading from v2.5.5 or older versions, make sure to apply <a href="/AppManager/zh-CN/guide/settings-page.html#默认开启-禁用组件-选项">Global Component Blocking</a> which will import all the rules from this directory automatically (you can later disable this option).</p></div> <p>Maintaining a database should be the best choice when it comes to storing data. But for now, I'll be using several <code>tsv</code> files with each file having the name of the package and a <code>.tsv</code> extension. The file/database will be queried/processed by the <code>RulesStorageManager</code> class. Due to this abstraction, it should be easier to switch to database or encrypted database systems in future without changing the design of the entire project.</p> <h2 id="rules-file-format"><a href="#rules-file-format" class="header-anchor">#</a> Rules File Format</h2> <h3 id="internal"><a href="#internal" class="header-anchor">#</a> Internal</h3> <p>The format below is used internally within App Manager and <em>is not compatible with the external format.</em></p> <div class="language- line-numbers-mode"><pre class="language-text"><code>&lt;name&gt; &lt;type&gt; &lt;mode&gt;|&lt;component_status&gt;|&lt;is_granted&gt;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>Where:</p> <ul><li><code>&lt;name&gt;</code> - Component/permission/app op name (in case of app op, it could be string or integer)</li> <li><code>&lt;type&gt;</code> - One of the <code>ACTIVITY</code>, <code>RECEIVER</code>, <code>PROVIDER</code>, <code>SERVICE</code>, <code>APP_OP</code>,  <code>PERMISSION</code></li> <li><code>&lt;mode&gt;</code> - (For app ops) The associated <a href="/AppManager/zh-CN/tech/AppOps.html#mode-constants">mode constant</a></li> <li><code>&lt;component_status&gt;</code> - (For components) Component status
<ul><li><code>true</code> - Component has been applied (<code>true</code> value is kept for compatibility)</li> <li><code>false</code> - Component hasn't been applied yet, but will be applied in future (<code>false</code> value is kept for compatibility)</li> <li><code>unblocked</code> - Component is scheduled to be unblocked</li></ul></li> <li><code>&lt;is_granted&gt;</code> - (For permissions) Whether the permission is granted or revoked</li></ul> <h3 id="external"><a href="#external" class="header-anchor">#</a> External</h3> <p>External format is used for importing or exporting rules in App Manager.</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>&lt;package_name&gt; &lt;component_name&gt; &lt;type&gt; &lt;mode&gt;|&lt;component_status&gt;|&lt;is_granted&gt;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>This the format is essentially the same as above except for the first item which is the name of the package.</p> <div class="custom-block danger"><p class="custom-block-title">Caution</p> <p>The exprted rules have a different format than the internal one and should not be copied directly to the <strong>conf</strong> folder.</p></div></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">2020/11/19 上午10:00:53</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/AppManager/zh-CN/tech/AppOps.html" class="prev">
        App Ops
      </a></span> <!----></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/AppManager/assets/js/app.f133bcc3.js" defer></script><script src="/AppManager/assets/js/2.3aad57dd.js" defer></script><script src="/AppManager/assets/js/58.f23a0aaa.js" defer></script>
  </body>
</html>
